(this["webpackJsonphome-secure-monitor"]=this["webpackJsonphome-secure-monitor"]||[]).push([[0],{27:function(e,t,n){e.exports=n(61)},32:function(e,t,n){},33:function(e,t,n){},4:function(e,t,n){e.exports={liveVideo:"LiveVideo_liveVideo__1ZkFR",motion:"LiveVideo_motion__2L80a",controls:"LiveVideo_controls__kPM7Y"}},61:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),i=n(25),c=n.n(i),r=(n(32),n(33),n(5)),s=n(26),l=n.n(s),u=function(e){var t=e.canvas,n=e.url,o=e.onStart,a=e.onMessage,i=new WebSocket(n,"echo-protocol");i.binaryType="arraybuffer";var c=new l.a(t,"webgl",1,35),r=!1,s=function(e){i.send(JSON.stringify(e))},u=function(){i.close()};i.onopen=function(){console.log("socket is connected"),i.send(JSON.stringify({name:"camera",state:"timelapse"}))},i.onclose=function(e){console.log("socket is closed",e)},i.onerror=function(e){console.log("socket error",e)},i.onmessage=function(e){if("string"==typeof e.data){var t=JSON.parse(e.data);if(r||"camera"!==t.name||"settings"!==t.event)a&&a(t),console.log(t);else{var n=t.content,i=n.width,l=n.height;c.initCanvas(i,l),r=!0,o?o({width:i,height:l,send:s,close:u}):a&&a(t.content)}}else{var h=new Uint8Array(e.data);c.addFrame(h)}}},h=n(4),m=n.n(h),d=function(e){var t=e.url,n=Object(o.useState)("off"),i=Object(r.a)(n,2),c=i[0],s=i[1],l=Object(o.useState)({}),h=Object(r.a)(l,2),d=h[0],f=h[1],v=Object(o.useState)({}),g=Object(r.a)(v,2),w=g[0],p=g[1],b=Object(o.useState)(!1),E=Object(r.a)(b,2),O=E[0],j=E[1],k=Object(o.useRef)(),S=Object(o.useRef)();Object(o.useEffect)((function(){return"off"===c&&(u({canvas:k.current,url:t,onStart:p,onMessage:function(e){"camera"===e.name&&"motion"===e.event&&(j(!0),setTimeout((function(){j(!1)}),2e3))}}),s("timelapse")),function(){console.log("cleanup LiveVideo component"),w.close&&w.close()}}),[t]),Object(o.useEffect)((function(){var e=S.current.getBoundingClientRect(),t={width:e.width-4,height:e.height-4};t.width===d.width&&t.height===d.height||f(t)}),[d]);var y={};if(d.height&&w.height){var N=d.width/d.height,_=w.width/w.height;y=N>_?{width:d.height*_,height:d.height}:{width:d.width,height:d.width/_}}return a.a.createElement("div",{className:m.a.liveVideo+(O?" "+m.a.motion:""),ref:S},a.a.createElement("div",{className:m.a.controls},a.a.createElement("button",{onClick:function(){var e="on"===c?"timelapse":"on";s(e),w.send({name:"camera",state:e})}},"on"===c?"\u23f8\ufe0e":"\u23f5\ufe0e")),a.a.createElement("canvas",{className:m.a.video,ref:k,style:y}))};var f=function(){return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"App-content"},a.a.createElement("div",{className:"App-row"},a.a.createElement(d,{url:"ws://192.168.8.201:45837"}),a.a.createElement(d,{url:"ws://192.168.8.152:45837"})),a.a.createElement("div",{className:"App-row"},a.a.createElement(d,{url:"ws://192.168.8.153:45837"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(f,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.a29450e4.chunk.js.map